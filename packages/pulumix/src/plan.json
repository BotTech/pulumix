{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://github.com/bottech/pulumix/blob/main/packages/pulumix/src/plan.json",

  "title": "Pulumi Plan",
  "description": "A plan of a Pulumi deployment.",
  "type": "object",
  "properties": {
    "manifest": {
      "$comment": "From https://github.com/pulumi/pulumi/blob/134d7cb818dc5f2c01f2cdd239ff12d687f9460f/sdk/go/common/apitype/deployments.json. A ref doesn't work as it doesn't use valid references itself.",
      "title": "Deployment Manifest",
      "description": "Captures meta-information about a deployment, such as versions of binaries, etc.",
      "type": "object",
      "properties": {
        "time": {
          "description": "The deployment's start time.",
          "type": "string",
          "format": "date-time"
        },
        "magic": {
          "description": "A magic number used to validate the manifest's integrity.",
          "type": "string"
        },
        "version": {
          "description": "The version of the Pulumi engine that produced the deployment.",
          "type": "string"
        },
        "plugins": {
          "description": "Information about the plugins used by the deployment.",
          "type": "array",
          "nullable": false,
          "items": {
            "title": "Plugin Info",
            "description": "Information about a plugin.",
            "type": "object",
            "properties": {
              "name": {
                "description": "The plugin's name.",
                "type": "string"
              },
              "path": {
                "description": "The path of the plugin's binary.",
                "type": "string"
              },
              "type": {
                "description": "The plugin's type.",
                "type": "string",
                "enum": [
                  "analyzer",
                  "language",
                  "resource"
                ]
              },
              "version": {
                "description": "The plugin's version.",
                "type": "string"
              }
            },
            "required": [
              "name",
              "path",
              "type",
              "version"
            ],
            "additionalProperties": false
          }
        }
      },
      "required": [
        "time",
        "magic",
        "version"
      ],
      "additionalProperties": false
    },
    "resourcePlans": {
      "$comment": "See https://github.com/pulumi/pulumi/blob/516979770f11d3a426239429731cf9f327c38836/sdk/go/common/apitype/plan.go",
      "title": "Deployment Resource Plans",
      "description": "TODO",
      "type": "object",
      "patternProperties": {
        "^urn:": {
          "$ref": "#/$defs/resourcePlan",
          "type": "object"
        }
      },
      "required": []
    }
  },
  "required": [
    "manifest",
    "resourcePlans"
  ],
  "additionalProperties": false,

  "$defs": {
    "resourcePlan": {
      "title": "Deployment Resource Plan",
      "description": "TODO",
      "type": "object",
      "properties": {
        "goal": {
          "description": "The goal state for the resource.",
          "type": "object",
          "properties": {
            "type": {
              "description": "The type of resource.",
              "type": "string"
            },
            "name": {
              "description": "The name for the resource's URN.",
              "type": "string"
            },
            "custom": {
              "description": "true if this resource is custom, managed by a plugin.",
              "type": "boolean"
            },
            "inputDiff": {
              "description": "The resource properties that will be changed.",
              "type": "object"
            },
            "outputDiff": {
              "description": "The resource outputs that will be changed.",
              "type": "object"
            },
            "parent": {
              "description": "An optional parent URN for this resource.",
              "type": "string"
            },
            "protect": {
              "description": "true to protect this resource from deletion.",
              "type": "boolean"
            },
            "dependencies": {
              "description": "Dependencies of this resource object.",
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "provider": {
              "description": "The provider to use for this resource.",
              "type": "string"
            },
            "propertyDependencies": {
              "description": "The set of dependencies that affect each property.",
              "type": "object",
              "required": [],
              "additionalProperties": {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "uniqueItems": true
              }
            },
            "deleteBeforeReplace": {
              "description": "true if this resource should be deleted prior to replacement.",
              "type": "boolean"
            },
            "ignoreChanges": {
              "description": "A list of property names to ignore during changes.",
              "type": "array",
              "items": {
                "type": "string"
              },
              "uniqueItems": true
            },
            "additionalSecretOutputs": {
              "description": "Outputs that should always be treated as secrets.",
              "type": "array",
              "items": {
                "type": "string"
              },
              "uniqueItems": true
            },
            "aliases": {
              "description": "Additional URNs that should be aliased to this resource.",
              "type": "array",
              "items": {
                "type": "string"
              },
              "uniqueItems": true
            },
            "structuredAliases": {
              "description": "Structured alias objects to be assigned to this resource.",
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "URN": {
                    "type": "string"
                  },
                  "Name": {
                    "type": "string"
                  },
                  "Type": {
                    "type": "string"
                  },
                  "Project": {
                    "type": "string"
                  },
                  "Stack": {
                    "type": "string"
                  },
                  "Parent": {
                    "type": "string"
                  },
                  "NoParent": {
                    "type": "boolean"
                  }
                }
              }
            },
            "id": {
              "description": "The expected ID of the resource, if any.",
              "type": "string"
            },
            "customTimeouts": {
              "description": "An optional config object for resource options.",
              "type": "object",
              "properties": {
                "create": {
                  "type": "number"
                },
                "update": {
                  "type": "number"
                },
                "delete": {
                  "type": "number"
                }
              }
            }
          }
        },
        "steps": {
          "$comment": "See https://github.com/pulumi/pulumi/blob/87d1090d9f2a70a08ae2684d3108172418720f54/sdk/go/common/apitype/history.go",
          "description": "The steps to be performed on the resource.",
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "same",
              "create",
              "update",
              "delete",
              "replace",
              "create-replacement",
              "delete-replaced",
              "read",
              "read-replacement",
              "refresh",
              "discard",
              "discard-replaced",
              "remove-pending-replace",
              "import",
              "import-replacement"
            ]
          },
          "uniqueItems": true
        },
        "state": {
          "description": "The proposed outputs for the resource, if any. Purely advisory.",
          "type": "object"
        },
        "seed": {
          "description": "The random byte seed used for resource goal (base64 encoded).",
          "type": "string"
        }
      },
      "required": []
    }
  }
}
