# @bottech/pulumix-schema

JSON schemas for Pulumi plan types, generated from the official Pulumi SDK.

## Overview

This package contains JSON schemas generated from Pulumi's `plan.go` types for
different versions of the Pulumi SDK. The schemas are automatically generated by
analyzing the git history of the Pulumi repository and extracting type definitions
from tagged releases.

## Usage

The generated schemas are stored in the `schemas/` directory, organized by type and version:

```text
schemas/
  plan/
    v3.112.0/
      plan.json
      plan.d.ts
      metadata.json
    v3.113.0/
      plan.json
      plan.d.ts
      metadata.json
    ...
```

## Generating Schemas

Generate the schemas:

```bash
pnpm run generate
```

This will:

1. Clone or update the Pulumi repository (bare clone for efficiency)
2. Discover all v3.x.x tagged versions
3. For each version, extract the `plan.go` file
4. Generate a JSON schema using Go's `jsonschema` package
5. Save the schema to `schemas/plan/<version>/plan.json`

## Maintenance

To update schemas when new Pulumi versions are released:

```bash
pnpm run generate
```

The generator will automatically fetch the latest tags and generate schemas for
any new versions.

## Technical Details

### Go Generator

The generator is implemented in Go and uses:

- **invopop/jsonschema**: For generating JSON schemas from Go types
- **git commands**: For repository navigation (bare clone, cat-file, etc.)
- **Pulumi SDK**: The official types are imported directly

### Version Selection

- Only v3.x.x versions are processed (configurable via `minorVersion` constant)
- Versions are sorted semantically
- Handles cases where `plan.go` might not exist in older versions

### Output Format

Each version gets its own directory:

```text
schemas/
  v3.112.0/
    plan.json
  v3.113.0/
    plan.json
  ...
```
